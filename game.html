<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <base href="/" />
    <meta
      name="viewport"
      content="width=device-width, height=device-height, initial-scale=1"
    />
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üèú</text></svg>"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@lowlighter/matcha@3.0.0/dist/matcha.min.css" />
    <link rel="stylesheet" href="./css/matcha-override.css" />
    <link rel="stylesheet" href="./css/animation.css" />
    <link rel="stylesheet" href="./css/central.css" />

    <title>Badlands Online</title>

    <script type="text/javascript">
      const CLIENT_WEBSOCKET_ADDRESS = '${CLIENT_WEBSOCKET_ADDRESS}';
      let playerId = '${PLAYER_ID}'; // Replaced server side before returning the page
    </script>

    <script src="./clientjs/utils.js"></script>
    <script src="./clientjs/websocket.js"></script>
    <script src="./sharedjs/websocket-actions.mjs" type="module"></script>

    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs/dist/cdn.min.js"
    ></script>
  </head>
  <body x-data="gs">
    <section x-data="ui">
      <header>
        <menu>
          <li>
            Debug
            <menu>
              <li>
                Customize Layout
                <menu>
                  <li>Show Chat</li>
                  <li>Show Log</li>
                  <li>Show Timer</li>
                </menu>
              </li>
            </menu>
          </li>
          <li>
            Join As
            <menu>
              <li onclick="action.joinGame('player1')">Be Player 1</li>
              <li onclick="action.joinGame('player2')">Be Player 2</li>
            </menu>
          </li>
        </menu>
      </header>

      <div class="draw-pile" title="Draw a card for 2 Water">
        <img onclick="action.drawCard({ fromWater: true })" src="images/cards/people/punk.png" draggable="false" />
      </div>
      <template x-if="playDrawAnimation">
        <img src="images/cards/people/punk.png" class="draw-animation" />
      </template>

      <div class="water-wrap">
        <template x-for="water in ui.waterCount">
          <img src="images/water.png" class="water-token" draggable="false" />
        </template>
      </div>

      <div class="slots">
        <template x-for="slot in slots">
          <div
            class="bd-default"
            x-on:dragover.prevent="if (slot.content) { return false; } $el.classList.add('slot-highlight')"
            x-on:dragleave="$el.classList.remove('slot-highlight')"
            x-on:drop.prevent="$el.classList.remove('slot-highlight'); dropCardInSlot(event, slot)"
          >
            <template x-if="slot.content">
              <img :alt="slot.content" :src="'images/cards/people/' + slot.content.img" :class="slot.content.damage >= 1 ? 'damaged-card' : ''" />
            </template>
          </div>
        </template>
      </div>

      <footer>
        <template x-if="who">
          <div class="cards">
            <template x-for="card in getMyCards()">
              <div class="card">
                <img :alt="card" :src="'images/cards/people/' + card.img" draggable="true" x-on:dragstart.self="event.dataTransfer.effectAllowed='move'; event.dataTransfer.setData('text/plain', card.id);" />
              </div>
            </template>
          </div>
        </template>
      </footer>
    </section>

    <!-- JS scripts at the bottom like it's 1995 -->
    <script src="./clientjs/badlands.js"></script>
  </body>
</html>
